{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{\"7dTp\":function(l,n,e){\"use strict\";e.r(n);var t=e(\"8Y7J\");class u{}var i=e(\"pMnS\"),r=e(\"ZZ/e\"),a=e(\"oBZk\"),o=e(\"s7LF\"),s=e(\"SVse\"),c=e(\"mrSG\"),b=e(\"LG6+\"),h=e(\"01F9\"),d=e(\"Yttj\"),p=e(\"iWj2\"),g=e(\"h3kM\"),m=e(\"nYR2\");const f=\"my_images\";class x{constructor(l,n,e,t,u,i,r,a,o,s,c,b,h,d){this.camera=l,this.file=n,this.http=e,this.webview=t,this.actionSheetController=u,this.toastController=i,this.storage=r,this.platform=a,this.loadingController=o,this.ref=s,this.filePath=c,this.actRoute=b,this.Provider=h,this.router=d,this.images=[]}ngOnInit(){this.platform.ready().then(()=>{}),this.storage.get(\"session_storage\").then(l=>{this.anggota=l,this.id=this.anggota.id,console.log(l)})}pathForImage(l){return null===l?\"\":this.webview.convertFileSrc(l)}presentToast(l){return c.b(this,void 0,void 0,(function*(){(yield this.toastController.create({message:l,position:\"bottom\",duration:3e3})).present()}))}selectImage(){return c.b(this,void 0,void 0,(function*(){const l=yield this.actionSheetController.create({header:\"Select Image source\",buttons:[{text:\"Load from Library\",handler:()=>{this.takePicture(this.camera.PictureSourceType.PHOTOLIBRARY)}},{text:\"Use Camera\",handler:()=>{this.takePicture(this.camera.PictureSourceType.CAMERA)}},{text:\"Cancel\",role:\"cancel\"}]});yield l.present()}))}takePicture(l){this.camera.getPicture({quality:100,sourceType:l,saveToPhotoAlbum:!1,correctOrientation:!0}).then(n=>{if(this.platform.is(\"android\")&&l===this.camera.PictureSourceType.PHOTOLIBRARY)this.filePath.resolveNativePath(n).then(l=>{let e=l.substr(0,l.lastIndexOf(\"/\")+1),t=n.substring(n.lastIndexOf(\"/\")+1,n.lastIndexOf(\"?\"));this.copyFileToLocalDir(e,t,this.createFileName())});else{var e=n.substr(n.lastIndexOf(\"/\")+1),t=n.substr(0,n.lastIndexOf(\"/\")+1);this.copyFileToLocalDir(t,e,this.createFileName())}})}createFileName(){return(new Date).getTime()+\".jpg\"}copyFileToLocalDir(l,n,e){this.file.copyFile(l,n,this.file.dataDirectory,e).then(l=>{this.updateStoredImages(e)},l=>{this.presentToast(\"Error while storing file.\")})}updateStoredImages(l){this.storage.get(f).then(n=>{let e=JSON.parse(n);e?(e.push(l),this.storage.set(f,JSON.stringify(e))):this.storage.set(f,JSON.stringify([l]));let t=this.file.dataDirectory+l,u=this.pathForImage(t);this.images=[{name:l,path:u,filePath:t},...this.images],this.ref.detectChanges()})}deleteImage(l,n){this.images.splice(n,1),this.storage.get(f).then(n=>{let e=JSON.parse(n).filter(n=>n!=l.name);this.storage.set(f,JSON.stringify(e));var t=l.filePath.substr(0,l.filePath.lastIndexOf(\"/\")+1);this.file.removeFile(t,l.name).then(l=>{this.presentToast(\"File removed.\")})})}startUpload(l){this.file.resolveLocalFilesystemUrl(l.filePath).then(l=>{l.file(l=>this.readFile(l))}).catch(l=>{this.presentToast(\"Error while reading file.\")})}readFile(l){const n=new FileReader;n.onload=()=>{const e=new FormData,t=new Blob([n.result],{type:l.type});e.append(\"file\",t,l.name),e.append(\"mc_id\",this.mc_id),this.uploadImageData(e),console.log(e)},n.readAsArrayBuffer(l)}uploadImageData(l){return c.b(this,void 0,void 0,(function*(){const n=yield this.loadingController.create({message:\"Uploading image...\"});yield n.present(),this.http.post(\"http://192.168.64.2/server_easymc/upload_profile_mc.php\",l).pipe(Object(m.a)(()=>{n.dismiss()})).subscribe(l=>{this.presentToast(l.success?\"File upload complete.\":\"File upload failed.\")})}))}}var k=e(\"IheW\"),y=e(\"xgBC\"),C=e(\"iInd\"),v=t.qb({encapsulation:0,styles:[[\"\"]],data:{}});function I(l){return t.Ob(0,[(l()(),t.sb(0,0,null,null,2,\"h3\",[[\"text-center\",\"\"]],null,null,null,null,null)),t.rb(1,16384,null,0,r.d,[t.k],null,null),(l()(),t.Mb(-1,null,[\"Please Select Image!\"]))],null,null)}function O(l){return t.Ob(0,[(l()(),t.sb(0,0,null,null,20,\"ion-item\",[[\"text-wrap\",\"\"]],null,null,null,a.xb,a.x)),t.rb(1,49152,null,0,r.H,[t.h,t.k,t.x],null,null),t.rb(2,16384,null,0,r.d,[t.k],null,null),(l()(),t.sb(3,0,null,0,3,\"ion-thumbnail\",[[\"slot\",\"start\"]],null,null,null,a.Sb,a.U)),t.rb(4,49152,null,0,r.zb,[t.h,t.k,t.x],null,null),(l()(),t.sb(5,0,null,0,1,\"ion-img\",[],null,null,null,a.rb,a.t)),t.rb(6,49152,null,0,r.D,[t.h,t.k,t.x],{src:[0,\"src\"]},null),(l()(),t.sb(7,0,null,0,2,\"ion-label\",[],null,null,null,a.yb,a.A)),t.rb(8,49152,null,0,r.N,[t.h,t.k,t.x],null,null),(l()(),t.Mb(9,0,[\" \",\" \"])),(l()(),t.sb(10,0,null,0,6,\"ion-input\",[[\"placeholder\",\"text\"],[\"style\",\"--background:#5555;\"],[\"type\",\"text\"]],[[2,\"ng-untouched\",null],[2,\"ng-touched\",null],[2,\"ng-pristine\",null],[2,\"ng-dirty\",null],[2,\"ng-valid\",null],[2,\"ng-invalid\",null],[2,\"ng-pending\",null]],[[null,\"ngModelChange\"],[null,\"ionBlur\"],[null,\"ionChange\"]],(function(l,n,e){var u=!0,i=l.component;return\"ionBlur\"===n&&(u=!1!==t.Eb(l,11)._handleBlurEvent(e.target)&&u),\"ionChange\"===n&&(u=!1!==t.Eb(l,11)._handleInputEvent(e.target)&&u),\"ngModelChange\"===n&&(u=!1!==(i.mc_id=e)&&u),u}),a.ub,a.w)),t.rb(11,16384,null,0,r.Pb,[t.k],null,null),t.Jb(1024,null,o.e,(function(l){return[l]}),[r.Pb]),t.rb(13,671744,null,0,o.h,[[8,null],[8,null],[8,null],[6,o.e]],{model:[0,\"model\"]},{update:\"ngModelChange\"}),t.Jb(2048,null,o.f,null,[o.h]),t.rb(15,16384,null,0,o.g,[[4,o.f]],null,null),t.rb(16,49152,null,0,r.G,[t.h,t.k,t.x],{placeholder:[0,\"placeholder\"],type:[1,\"type\"],value:[2,\"value\"]},null),(l()(),t.sb(17,0,null,0,3,\"ion-button\",[[\"fill\",\"clear\"],[\"slot\",\"end\"]],null,[[null,\"click\"]],(function(l,n,e){var t=!0;return\"click\"===n&&(t=!1!==l.component.deleteImage(l.context.$implicit,l.context.index)&&t),t}),a.bb,a.d)),t.rb(18,49152,null,0,r.k,[t.h,t.k,t.x],{fill:[0,\"fill\"]},null),(l()(),t.sb(19,0,null,0,1,\"ion-icon\",[[\"name\",\"trash\"],[\"slot\",\"icon-only\"]],null,null,null,a.qb,a.s)),t.rb(20,49152,null,0,r.C,[t.h,t.k,t.x],{name:[0,\"name\"]},null)],(function(l,n){var e=n.component;l(n,6,0,n.context.$implicit.path),l(n,13,0,e.mc_id),l(n,16,0,\"text\",\"text\",t.wb(1,\"\",e.id,\"\")),l(n,18,0,\"clear\"),l(n,20,0,\"trash\")}),(function(l,n){l(n,9,0,n.context.$implicit.name),l(n,10,0,t.Eb(n,15).ngClassUntouched,t.Eb(n,15).ngClassTouched,t.Eb(n,15).ngClassPristine,t.Eb(n,15).ngClassDirty,t.Eb(n,15).ngClassValid,t.Eb(n,15).ngClassInvalid,t.Eb(n,15).ngClassPending)}))}function F(l){return t.Ob(0,[(l()(),t.sb(0,0,null,null,5,\"ion-item\",[],null,null,null,a.xb,a.x)),t.rb(1,49152,null,0,r.H,[t.h,t.k,t.x],null,null),(l()(),t.sb(2,0,null,0,3,\"ion-button\",[[\"fill\",\"clear\"],[\"slot\",\"end\"]],null,[[null,\"click\"]],(function(l,n,e){var t=!0;return\"click\"===n&&(t=!1!==l.component.startUpload(l.context.$implicit)&&t),t}),a.bb,a.d)),t.rb(3,49152,null,0,r.k,[t.h,t.k,t.x],{fill:[0,\"fill\"]},null),(l()(),t.sb(4,0,null,0,1,\"ion-icon\",[[\"name\",\"cloud-upload\"],[\"slot\",\"icon-only\"]],null,null,null,a.qb,a.s)),t.rb(5,49152,null,0,r.C,[t.h,t.k,t.x],{name:[0,\"name\"]},null)],(function(l,n){l(n,3,0,\"clear\"),l(n,5,0,\"cloud-upload\")}),null)}function P(l){return t.Ob(0,[(l()(),t.sb(0,0,null,null,8,\"ion-footer\",[],null,null,null,a.nb,a.p)),t.rb(1,49152,null,0,r.z,[t.h,t.k,t.x],null,null),(l()(),t.sb(2,0,null,0,6,\"ion-toolbar\",[[\"color\",\"primary\"]],null,null,null,a.Ub,a.W)),t.rb(3,49152,null,0,r.Cb,[t.h,t.k,t.x],{color:[0,\"color\"]},null),(l()(),t.sb(4,0,null,0,4,\"ion-button\",[[\"color\",\"light\"],[\"expand\",\"full\"],[\"fill\",\"clear\"]],null,[[null,\"click\"]],(function(l,n,e){var t=!0;return\"click\"===n&&(t=!1!==l.component.selectImage()&&t),t}),a.bb,a.d)),t.rb(5,49152,null,0,r.k,[t.h,t.k,t.x],{color:[0,\"color\"],expand:[1,\"expand\"],fill:[2,\"fill\"]},null),(l()(),t.sb(6,0,null,0,1,\"ion-icon\",[[\"name\",\"camera\"],[\"slot\",\"start\"]],null,null,null,a.qb,a.s)),t.rb(7,49152,null,0,r.C,[t.h,t.k,t.x],{name:[0,\"name\"]},null),(l()(),t.Mb(-1,0,[\" Select Image\"]))],(function(l,n){l(n,3,0,\"primary\"),l(n,5,0,\"light\",\"full\",\"clear\"),l(n,7,0,\"camera\")}),null)}function S(l){return t.Ob(0,[(l()(),t.sb(0,0,null,null,6,\"ion-header\",[],null,null,null,a.pb,a.r)),t.rb(1,49152,null,0,r.B,[t.h,t.k,t.x],null,null),(l()(),t.sb(2,0,null,0,4,\"ion-toolbar\",[[\"color\",\"primary\"]],null,null,null,a.Ub,a.W)),t.rb(3,49152,null,0,r.Cb,[t.h,t.k,t.x],{color:[0,\"color\"]},null),(l()(),t.sb(4,0,null,0,2,\"ion-title\",[],null,null,null,a.Tb,a.V)),t.rb(5,49152,null,0,r.Ab,[t.h,t.k,t.x],null,null),(l()(),t.Mb(-1,0,[\" Ionic Image Upload \"])),(l()(),t.sb(7,0,null,null,10,\"ion-content\",[[\"padding\",\"\"]],null,null,null,a.kb,a.m)),t.rb(8,49152,null,0,r.u,[t.h,t.k,t.x],null,null),t.rb(9,16384,null,0,r.d,[t.k],null,null),(l()(),t.hb(16777216,null,0,1,null,I)),t.rb(11,16384,null,0,s.j,[t.N,t.K],{ngIf:[0,\"ngIf\"]},null),(l()(),t.sb(12,0,null,0,3,\"ion-list\",[],null,null,null,a.zb,a.B)),t.rb(13,49152,null,0,r.O,[t.h,t.k,t.x],null,null),(l()(),t.hb(16777216,null,0,1,null,O)),t.rb(15,278528,null,0,s.i,[t.N,t.K,t.q],{ngForOf:[0,\"ngForOf\"]},null),(l()(),t.hb(16777216,null,0,1,null,F)),t.rb(17,278528,null,0,s.i,[t.N,t.K,t.q],{ngForOf:[0,\"ngForOf\"]},null),(l()(),t.hb(16777216,null,null,1,null,P)),t.rb(19,16384,null,0,s.j,[t.N,t.K],{ngIf:[0,\"ngIf\"]},null)],(function(l,n){var e=n.component;l(n,3,0,\"primary\"),l(n,11,0,0==e.images.length),l(n,15,0,e.images),l(n,17,0,e.images),l(n,19,0,0==e.images.length)}),null)}function w(l){return t.Ob(0,[(l()(),t.sb(0,0,null,null,1,\"app-upload-profile\",[],null,null,null,S,v)),t.rb(1,114688,null,0,x,[b.a,h.a,k.c,d.a,r.a,r.Qb,y.b,r.Lb,r.Gb,t.h,p.a,C.a,g.a,C.m],null,null)],(function(l,n){l(n,1,0)}),null)}var T=t.ob(\"app-upload-profile\",x,w,{},{},[]);class E{}e.d(n,\"UploadProfilePageModuleNgFactory\",(function(){return N}));var N=t.pb(u,[],(function(l){return t.Bb([t.Cb(512,t.j,t.ab,[[8,[i.a,T]],[3,t.j],t.v]),t.Cb(4608,s.l,s.k,[t.s,[2,s.z]]),t.Cb(4608,o.j,o.j,[]),t.Cb(4608,r.b,r.b,[t.x,t.g]),t.Cb(4608,r.Hb,r.Hb,[r.b,t.j,t.p]),t.Cb(4608,r.Mb,r.Mb,[r.b,t.j,t.p]),t.Cb(1073742336,s.b,s.b,[]),t.Cb(1073742336,o.i,o.i,[]),t.Cb(1073742336,o.a,o.a,[]),t.Cb(1073742336,r.Eb,r.Eb,[]),t.Cb(1073742336,C.n,C.n,[[2,C.s],[2,C.m]]),t.Cb(1073742336,E,E,[]),t.Cb(1073742336,u,u,[]),t.Cb(1024,C.k,(function(){return[[{path:\"\",component:x}]]}),[])])}))}}]);","extractedComments":[]}