(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{rkXJ:function(e,t,i){"use strict";i.r(t);var s=i("8Y7J");class a{}var r=i("pMnS"),o=i("mrSG"),l=i("LG6+"),n=i("ZZ/e"),h=i("01F9"),p=i("Yttj"),c=i("iWj2"),u=i("h3kM"),d=i("nYR2");const m="my_images";class b{constructor(e,t,i,s,a,r,o,l,n,h,p,c,u,d){this.camera=e,this.file=t,this.http=i,this.webview=s,this.actionSheetController=a,this.toastController=r,this.storage=o,this.platform=l,this.loadingController=n,this.ref=h,this.filePath=p,this.actRoute=c,this.Provider=u,this.router=d,this.images=[]}ngOnInit(){this.actRoute.params.subscribe(e=>{this.employer_id=e.employer_id,this.img_profile=e.img_profile,console.log(e)}),this.platform.ready().then(()=>{this.loadStoredImages()})}loadStoredImages(){this.storage.get(m).then(e=>{if(e){let t=JSON.parse(e);this.images=[];for(let e of t){let t=this.file.dataDirectory+e,i=this.pathForImage(t);this.images.push({name:e,path:i,filePath:t})}}})}pathForImage(e){return null===e?"":this.webview.convertFileSrc(e)}presentToast(e){return o.b(this,void 0,void 0,(function*(){(yield this.toastController.create({message:e,position:"bottom",duration:3e3})).present()}))}selectImage(){return o.b(this,void 0,void 0,(function*(){const e=yield this.actionSheetController.create({header:"Select Image source",buttons:[{text:"Load from Library",handler:()=>{this.takePicture(this.camera.PictureSourceType.PHOTOLIBRARY)}},{text:"Use Camera",handler:()=>{this.takePicture(this.camera.PictureSourceType.CAMERA)}},{text:"Cancel",role:"cancel"}]});yield e.present()}))}takePicture(e){this.camera.getPicture({quality:100,sourceType:e,saveToPhotoAlbum:!1,correctOrientation:!0}).then(t=>{if(this.platform.is("android")&&e===this.camera.PictureSourceType.PHOTOLIBRARY)this.filePath.resolveNativePath(t).then(e=>{let i=e.substr(0,e.lastIndexOf("/")+1),s=t.substring(t.lastIndexOf("/")+1,t.lastIndexOf("?"));this.copyFileToLocalDir(i,s,this.createFileName())});else{var i=t.substr(t.lastIndexOf("/")+1),s=t.substr(0,t.lastIndexOf("/")+1);this.copyFileToLocalDir(s,i,this.createFileName())}})}createFileName(){return(new Date).getTime()+".jpg"}copyFileToLocalDir(e,t,i){this.file.copyFile(e,t,this.file.dataDirectory,i).then(e=>{this.updateStoredImages(i)},e=>{this.presentToast("Error while storing file.")})}updateStoredImages(e){this.storage.get(m).then(t=>{let i=JSON.parse(t);i?(i.push(e),this.storage.set(m,JSON.stringify(i))):this.storage.set(m,JSON.stringify([e]));let s=this.file.dataDirectory+e,a=this.pathForImage(s);this.images=[{name:e,path:a,filePath:s},...this.images],this.ref.detectChanges()})}deleteImage(e,t){this.images.splice(t,1),this.storage.get(m).then(t=>{let i=JSON.parse(t).filter(t=>t!=e.name);this.storage.set(m,JSON.stringify(i));var s=e.filePath.substr(0,e.filePath.lastIndexOf("/")+1);this.file.removeFile(s,e.name).then(e=>{this.presentToast("File removed.")})})}startUpload(e){this.file.resolveLocalFilesystemUrl(e.filePath).then(e=>{e.file(e=>this.readFile(e))}).catch(e=>{this.presentToast("Error while reading file.")})}readFile(e){const t=new FileReader;t.onload=()=>{const i=new FormData,s=new Blob([t.result],{type:e.type});i.append("file",s,e.name),this.uploadImageData(i)},t.readAsArrayBuffer(e)}uploadImageData(e){return o.b(this,void 0,void 0,(function*(){const t=yield this.loadingController.create({message:"Uploading image..."});yield t.present(),this.http.post("http://192.168.64.2/server_easymc/upload.php",e).pipe(Object(d.a)(()=>{t.dismiss()})).subscribe(e=>{this.presentToast(e.success?"File upload complete.":"File upload failed.")})}))}updateProses(){return new Promise(e=>{this.Provider.postData({aksi:"update",img_profile:this.img_profile},"upload.php").subscribe(e=>{this.router.navigate(["/employer/profileem"]),console.log("OK")})})}}var f=i("IheW"),g=i("xgBC"),y=i("iInd"),v=s.qb({encapsulation:0,styles:[[""]],data:{}});function C(e){return s.Ob(0,[],null,null)}function F(e){return s.Ob(0,[(e()(),s.sb(0,0,null,null,1,"app-uploadprofile",[],null,null,null,C,v)),s.rb(1,114688,null,0,b,[l.a,h.a,f.c,p.a,n.a,n.Qb,g.b,n.Lb,n.Gb,s.h,c.a,y.a,u.a,y.m],null,null)],(function(e,t){e(t,1,0)}),null)}var I=s.ob("app-uploadprofile",b,F,{},{},[]),P=i("SVse"),O=i("s7LF");class S{}i.d(t,"UploadprofilePageModuleNgFactory",(function(){return w}));var w=s.pb(a,[],(function(e){return s.Bb([s.Cb(512,s.j,s.ab,[[8,[r.a,I]],[3,s.j],s.v]),s.Cb(4608,P.l,P.k,[s.s,[2,P.z]]),s.Cb(4608,O.j,O.j,[]),s.Cb(4608,n.b,n.b,[s.x,s.g]),s.Cb(4608,n.Hb,n.Hb,[n.b,s.j,s.p]),s.Cb(4608,n.Mb,n.Mb,[n.b,s.j,s.p]),s.Cb(1073742336,P.b,P.b,[]),s.Cb(1073742336,O.i,O.i,[]),s.Cb(1073742336,O.a,O.a,[]),s.Cb(1073742336,n.Eb,n.Eb,[]),s.Cb(1073742336,y.n,y.n,[[2,y.s],[2,y.m]]),s.Cb(1073742336,S,S,[]),s.Cb(1073742336,a,a,[]),s.Cb(1024,y.k,(function(){return[[{path:"",component:b}]]}),[])])}))}}]);