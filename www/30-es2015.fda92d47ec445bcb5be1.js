(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{E3o2:function(l,n,e){"use strict";e.r(n);var t=e("8Y7J");class i{}var r=e("pMnS"),u=e("ZZ/e"),o=e("oBZk"),a=e("SVse"),s=e("mrSG"),c=e("LG6+"),b=e("01F9"),h=e("Yttj"),p=e("iWj2"),m=e("nYR2");const d="my_images";class f{constructor(l,n,e,t,i,r,u,o,a,s,c){this.camera=l,this.file=n,this.http=e,this.webview=t,this.actionSheetController=i,this.toastController=r,this.storage=u,this.platform=o,this.loadingController=a,this.ref=s,this.filePath=c,this.img_profile=[]}ngOnInit(){this.platform.ready().then(()=>{this.loadStoredImages()})}loadStoredImages(){this.storage.get(d).then(l=>{if(l){let n=JSON.parse(l);this.img_profile=[];for(let l of n){let n=this.file.dataDirectory+l,e=this.pathForImage(n);this.img_profile.push({name:l,path:e,filePath:n})}}})}pathForImage(l){return null===l?"":this.webview.convertFileSrc(l)}presentToast(l){return s.b(this,void 0,void 0,(function*(){(yield this.toastController.create({message:l,position:"bottom",duration:3e3})).present()}))}selectImage(){return s.b(this,void 0,void 0,(function*(){const l=yield this.actionSheetController.create({header:"Select Image source",buttons:[{text:"Load from Library",handler:()=>{this.takePicture(this.camera.PictureSourceType.PHOTOLIBRARY)}},{text:"Use Camera",handler:()=>{this.takePicture(this.camera.PictureSourceType.CAMERA)}},{text:"Cancel",role:"cancel"}]});yield l.present()}))}takePicture(l){this.camera.getPicture({quality:100,sourceType:l,saveToPhotoAlbum:!1,correctOrientation:!0}).then(n=>{if(this.platform.is("android")&&l===this.camera.PictureSourceType.PHOTOLIBRARY)this.filePath.resolveNativePath(n).then(l=>{let e=l.substr(0,l.lastIndexOf("/")+1),t=n.substring(n.lastIndexOf("/")+1,n.lastIndexOf("?"));this.copyFileToLocalDir(e,t,this.createFileName())});else{var e=n.substr(n.lastIndexOf("/")+1),t=n.substr(0,n.lastIndexOf("/")+1);this.copyFileToLocalDir(t,e,this.createFileName())}})}createFileName(){return(new Date).getTime()+".jpg"}copyFileToLocalDir(l,n,e){this.file.copyFile(l,n,this.file.dataDirectory,e).then(l=>{this.updateStoredImages(e)},l=>{this.presentToast("Error while storing file.")})}updateStoredImages(l){this.storage.get(d).then(n=>{let e=JSON.parse(n);e?(e.push(l),this.storage.set(d,JSON.stringify(e))):this.storage.set(d,JSON.stringify([l]));let t=this.file.dataDirectory+l,i=this.pathForImage(t);this.img_profile=[{name:l,path:i,filePath:t},...this.img_profile],this.ref.detectChanges()})}deleteImage(l,n){this.img_profile.splice(n,1),this.storage.get(d).then(n=>{let e=JSON.parse(n).filter(n=>n!=l.name);this.storage.set(d,JSON.stringify(e));var t=l.filePath.substr(0,l.filePath.lastIndexOf("/")+1);this.file.removeFile(t,l.name).then(l=>{this.presentToast("File removed.")})})}startUpload(l){this.file.resolveLocalFilesystemUrl(l.filePath).then(l=>{l.file(l=>this.readFile(l))}).catch(l=>{this.presentToast("Error while reading file.")})}readFile(l){const n=new FileReader;n.onload=()=>{const e=new FormData,t=new Blob([n.result],{type:l.type});e.append("file",t,l.name),this.uploadImageData(e)},n.readAsArrayBuffer(l)}uploadImageData(l){return s.b(this,void 0,void 0,(function*(){const n=yield this.loadingController.create({message:"Uploading image..."});yield n.present(),this.http.post("http://192.168.64.2/server_easymc/upload.php",l).pipe(Object(m.a)(()=>{n.dismiss()})).subscribe(l=>{this.presentToast(l.success?"File upload complete.":"File upload failed.")})}))}}var g=e("IheW"),k=e("xgBC"),x=t.qb({encapsulation:0,styles:[[""]],data:{}});function y(l){return t.Ob(0,[(l()(),t.sb(0,0,null,null,2,"h3",[["text-center",""]],null,null,null,null,null)),t.rb(1,16384,null,0,u.d,[t.k],null,null),(l()(),t.Mb(-1,null,["Please Select Image!"]))],null,null)}function C(l){return t.Ob(0,[(l()(),t.sb(0,0,null,null,17,"ion-item",[["text-wrap",""]],null,null,null,o.xb,o.x)),t.rb(1,49152,null,0,u.H,[t.h,t.k,t.x],null,null),t.rb(2,16384,null,0,u.d,[t.k],null,null),(l()(),t.sb(3,0,null,0,3,"ion-thumbnail",[["slot","start"]],null,null,null,o.Sb,o.U)),t.rb(4,49152,null,0,u.zb,[t.h,t.k,t.x],null,null),(l()(),t.sb(5,0,null,0,1,"ion-img",[],null,null,null,o.rb,o.t)),t.rb(6,49152,null,0,u.D,[t.h,t.k,t.x],{src:[0,"src"]},null),(l()(),t.sb(7,0,null,0,2,"ion-label",[],null,null,null,o.yb,o.A)),t.rb(8,49152,null,0,u.N,[t.h,t.k,t.x],null,null),(l()(),t.Mb(9,0,[" "," "])),(l()(),t.sb(10,0,null,0,3,"ion-button",[["fill","clear"],["slot","end"]],null,[[null,"click"]],(function(l,n,e){var t=!0;return"click"===n&&(t=!1!==l.component.startUpload(l.context.$implicit)&&t),t}),o.bb,o.d)),t.rb(11,49152,null,0,u.k,[t.h,t.k,t.x],{fill:[0,"fill"]},null),(l()(),t.sb(12,0,null,0,1,"ion-icon",[["name","cloud-upload"],["slot","icon-only"]],null,null,null,o.qb,o.s)),t.rb(13,49152,null,0,u.C,[t.h,t.k,t.x],{name:[0,"name"]},null),(l()(),t.sb(14,0,null,0,3,"ion-button",[["fill","clear"],["slot","end"]],null,[[null,"click"]],(function(l,n,e){var t=!0;return"click"===n&&(t=!1!==l.component.deleteImage(l.context.$implicit,l.context.index)&&t),t}),o.bb,o.d)),t.rb(15,49152,null,0,u.k,[t.h,t.k,t.x],{fill:[0,"fill"]},null),(l()(),t.sb(16,0,null,0,1,"ion-icon",[["name","trash"],["slot","icon-only"]],null,null,null,o.qb,o.s)),t.rb(17,49152,null,0,u.C,[t.h,t.k,t.x],{name:[0,"name"]},null)],(function(l,n){l(n,6,0,n.context.$implicit.path),l(n,11,0,"clear"),l(n,13,0,"cloud-upload"),l(n,15,0,"clear"),l(n,17,0,"trash")}),(function(l,n){l(n,9,0,n.context.$implicit.name)}))}function I(l){return t.Ob(0,[(l()(),t.sb(0,0,null,null,9,"ion-header",[],null,null,null,o.pb,o.r)),t.rb(1,49152,null,0,u.B,[t.h,t.k,t.x],null,null),(l()(),t.sb(2,0,null,0,7,"ion-toolbar",[],null,null,null,o.Ub,o.W)),t.rb(3,49152,null,0,u.Cb,[t.h,t.k,t.x],null,null),(l()(),t.sb(4,0,null,0,5,"ion-buttons",[["slot","primary"]],null,null,null,o.cb,o.e)),t.rb(5,49152,null,0,u.l,[t.h,t.k,t.x],null,null),(l()(),t.sb(6,0,null,0,3,"ion-button",[["color","dark"]],null,null,null,o.bb,o.d)),t.rb(7,49152,null,0,u.k,[t.h,t.k,t.x],{color:[0,"color"]},null),(l()(),t.sb(8,0,null,0,1,"ion-icon",[["name","search"],["slot","icon-only"]],null,null,null,o.qb,o.s)),t.rb(9,49152,null,0,u.C,[t.h,t.k,t.x],{name:[0,"name"]},null),(l()(),t.sb(10,0,null,null,8,"ion-content",[["padding",""]],null,null,null,o.kb,o.m)),t.rb(11,49152,null,0,u.u,[t.h,t.k,t.x],null,null),t.rb(12,16384,null,0,u.d,[t.k],null,null),(l()(),t.hb(16777216,null,0,1,null,y)),t.rb(14,16384,null,0,a.j,[t.N,t.K],{ngIf:[0,"ngIf"]},null),(l()(),t.sb(15,0,null,0,3,"ion-list",[],null,null,null,o.zb,o.B)),t.rb(16,49152,null,0,u.O,[t.h,t.k,t.x],null,null),(l()(),t.hb(16777216,null,0,1,null,C)),t.rb(18,278528,null,0,a.i,[t.N,t.K,t.q],{ngForOf:[0,"ngForOf"]},null),(l()(),t.sb(19,0,null,null,8,"ion-footer",[],null,null,null,o.nb,o.p)),t.rb(20,49152,null,0,u.z,[t.h,t.k,t.x],null,null),(l()(),t.sb(21,0,null,0,6,"ion-toolbar",[["color","primary"]],null,null,null,o.Ub,o.W)),t.rb(22,49152,null,0,u.Cb,[t.h,t.k,t.x],{color:[0,"color"]},null),(l()(),t.sb(23,0,null,0,4,"ion-button",[["color","light"],["expand","full"],["fill","clear"]],null,[[null,"click"]],(function(l,n,e){var t=!0;return"click"===n&&(t=!1!==l.component.selectImage()&&t),t}),o.bb,o.d)),t.rb(24,49152,null,0,u.k,[t.h,t.k,t.x],{color:[0,"color"],expand:[1,"expand"],fill:[2,"fill"]},null),(l()(),t.sb(25,0,null,0,1,"ion-icon",[["name","camera"],["slot","start"]],null,null,null,o.qb,o.s)),t.rb(26,49152,null,0,u.C,[t.h,t.k,t.x],{name:[0,"name"]},null),(l()(),t.Mb(-1,0,[" Select Image"]))],(function(l,n){var e=n.component;l(n,7,0,"dark"),l(n,9,0,"search"),l(n,14,0,0==e.img_profile.length),l(n,18,0,e.img_profile),l(n,22,0,"primary"),l(n,24,0,"light","full","clear"),l(n,26,0,"camera")}),null)}function v(l){return t.Ob(0,[(l()(),t.sb(0,0,null,null,1,"app-notification",[],null,null,null,I,x)),t.rb(1,114688,null,0,f,[c.a,b.a,g.c,h.a,u.a,u.Qb,k.b,u.Lb,u.Gb,t.h,p.a],null,null)],(function(l,n){l(n,1,0)}),null)}var O=t.ob("app-notification",f,v,{},{},[]),F=e("s7LF"),S=e("iInd");class P{}e.d(n,"NotificationPageModuleNgFactory",(function(){return w}));var w=t.pb(i,[],(function(l){return t.Bb([t.Cb(512,t.j,t.ab,[[8,[r.a,O]],[3,t.j],t.v]),t.Cb(4608,a.l,a.k,[t.s,[2,a.z]]),t.Cb(4608,F.j,F.j,[]),t.Cb(4608,u.b,u.b,[t.x,t.g]),t.Cb(4608,u.Hb,u.Hb,[u.b,t.j,t.p]),t.Cb(4608,u.Mb,u.Mb,[u.b,t.j,t.p]),t.Cb(1073742336,a.b,a.b,[]),t.Cb(1073742336,F.i,F.i,[]),t.Cb(1073742336,F.a,F.a,[]),t.Cb(1073742336,u.Eb,u.Eb,[]),t.Cb(1073742336,S.n,S.n,[[2,S.s],[2,S.m]]),t.Cb(1073742336,P,P,[]),t.Cb(1073742336,i,i,[]),t.Cb(1024,S.k,(function(){return[[{path:"",component:f}]]}),[])])}))}}]);